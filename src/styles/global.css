@import "tailwindcss";
@import "./typography.css";

@custom-variant dark (&:where(.dark, .dark *));

/* COLOR SCHEME */
.dark {
  --background: var(--color-zinc-800);
  --foreground: var(--color-zinc-300);
  --accent: var(--color-yellow-500);
}

.light {
  --background: var(--color-gray-100);
  --foreground: var(--color-gray-800);
  --accent: var(--color-blue-500);
}

/* CODE BLOCK */
.light {
  .astro-code,
  .astro-code span {
    color: var(--shiki-light) !important;
    background-color: var(--shiki-light-bg) !important;
  }
}
.dark {
  .astro-code,
  .astro-code span {
    color: var(--shiki-dark) !important;
    background-color: var(--shiki-dark-bg) !important;
  }
}

/* INIT TAILWIND THEME */
@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-accent: var(--accent);

  --font-sans: "Space Grotesk Variable";
  --font-mono: "IBM Plex Mono";
}

/* BASE STYLING */
@layer base {
  html {
    @apply bg-background text-foreground selection:bg-accent selection:text-background overflow-y-scroll scroll-smooth antialiased;
  }
  body {
    --z-old: 1;
    --z-new: 2;
  }
  .dark {
    --z-old: 2;
    --z-new: 1;
  }

  button:not(:disabled) {
    cursor: pointer;
  }
}

/* SCROLLBAR STYLING */
@layer base {
  ::-webkit-scrollbar {
    width: 6px;
  }

  ::-webkit-scrollbar-track {
    background-color: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background-color: var(--color-foreground);
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-accent);
  }
}

/* COVER IMAGE */
@layer base {
  .cover-image {
    @apply relative mb-8;
    width: 100vw;
    left: 50%;
    transform: translateX(-50%);
  }
  .cover-image img {
    @apply w-full h-auto border-0 ring-0 cursor-default;
  }
  .cover-image figcaption {
    @apply static opacity-70 bg-transparent text-foreground text-sm py-2 text-center;
  }
}

/* FULL WIDTH IMAGE (for use in markdown articles) */
@layer base {
  .markdown figure.full-width {
    @apply relative my-8 px-6 md:px-12 z-10;
    width: 100vw;
    left: 50%;
    transform: translateX(-50%);
  }
  .markdown figure.full-width img {
    @apply w-full h-auto;
  }
}

/* LIGHTBOX */
@layer base {
  .lightbox img {
    @apply ring-0 border-0 cursor-zoom-out;
  }
}

/* PROFILE IMAGE DUOTONE */
.profile-image {
  position: relative;
}
.profile-image::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 9999px;
  mix-blend-mode: color;
  opacity: 0.6;
  pointer-events: none;
}
.light .profile-image::after {
  background: var(--accent);
}
.dark .profile-image::after {
  background: var(--color-yellow-700);
}
.profile-image img {
  filter: grayscale(100%) contrast(1.1);
}

/* TABLE OF CONTENTS */
@layer base {
  .toc-sidebar {
    @apply fixed hidden xl:block z-[5];
    left: calc(50% + 25rem);
    width: min(14rem, calc(50vw - 25rem - 1.5rem));
    max-height: 70vh;
    overflow-y: auto;
  }
  .toc-sidebar::-webkit-scrollbar {
    width: 2px;
  }
  .toc-sidebar ul {
    @apply list-none border-l border-foreground/15 p-0 m-0;
  }
  .toc-sidebar li {
    @apply p-0 m-0;
  }
  .toc-link {
    @apply block w-full cursor-pointer border-none bg-transparent py-1.5 pl-4 pr-2 text-left text-sm leading-snug opacity-40 transition-all duration-200 ease-in-out;
    text-decoration: none;
    color: var(--color-foreground);
  }
  .toc-link:hover {
    @apply opacity-80;
  }
  .toc-indent {
    @apply pl-7;
  }
  .toc-active {
    @apply opacity-100 font-medium;
    color: var(--color-accent);
    box-shadow: -1px 0 0 0 var(--color-accent);
  }
}

/* CLICKABLE IMAGES */
figure img,
.markdown img {
  cursor: pointer !important;
}
.cover-image img {
  cursor: default !important;
}

/* THEME TRANSITION */
::view-transition-old(root),
::view-transition-new(root) {
  animation: none;
  mix-blend-mode: normal;
}

::view-transition-old(root) {
  z-index: var(--z-old);
}
::view-transition-new(root) {
  z-index: var(--z-new);
}
